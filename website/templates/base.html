<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Base Page{% endblock %}</title>

    {% load static %}
    <link rel="shortcut icon" type="image/png" href="{% static 'image/chat_app.png' %}"/>
    <link rel="stylesheet" href="{% static 'css/base.css' %}"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    {% block head %}
        
    {% endblock %}
    <audio id="click-sound" src="{% static 'audios/click.mp3' %}" preload="auto"></audio>
</head>
<body class="white">

    <!-- ------------------------------------------------ -->
    {% if messages %}
            {% for message in messages %}
                {% if message.tags == 'error' %}
                    <div class="notifymessage error_msg" id="error_msg"> 
                        <span><i class="fa fa-times danger "></i> {{ message }}</span>
                    </div> 
                {% else %}
                    <div class="notifymessage success_msg" id="success_msg"> 
                        <span><i class="fa fa-times danger "></i> {{ message }}</span>
                    </div>    
                {% endif %}
            {% endfor %}
    {% endif %}

    <!-- ------------------------------------------------ -->
    {% if user.is_authenticated %}
        <span id="dark_light" onclick="playAudioBulb()"><i class="fa-solid fa-moon"></i></span>
    {% endif %}
   <!-- ------------------------------------------------ -->

    <aside>
        <!-- logo -->
        {% load static %}
        <div id="ChatAt_logo" >
            <a href="{% url 'public' %}" ><img src="{% static '/image/chatat.png' %}"></a>
        </div>

        <!-- seaarch users div -->
            
        {% if user.is_authenticated %}
            <div class="search-div">

                <form class="searchBox" action="{% url 'search_users' %}" method="POST">
                    {% csrf_token %}
                    <input class="searchInput" type="text"  name="query" placeholder="Search Users.." autocomplete="off" required >
                    <button type="submit"><i class="fa fa-search"></i></button>
                </form>


                {% if search_results %}
                    <div class="search-result">
                        {% for user in search_results %} 
                            <a href="{% url 'profile' pk=user.username %}">
                                <img src="{{ user.userprofile.profile_picture.url }}" alt="" style="width: 30px; height: 30px; border-radius: 20px;">
                                <span>@{{user.username }}</span>
                            </a>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        {% endif %}

        {% include "nav_bar.html" %}
        
    </aside>
    <!-- ------------------------------------------------ -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <script src="{% static 'js/base.js' %}"></script>

</body>

</html>